

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bringing up a Kafka-based Ordering Service &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Channels" href="channels.html" />
    <link rel="prev" title="Hyperledger Fabric SDKs" href="fabric-sdks.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
  <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="prereqs.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="samples.html">Hyperledger Fabric Samples</a></li>
</ul>
<p class="caption"><span class="caption-text">Key Concepts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="blockchain.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="capabilities.html">Hyperledger Fabric Capabilities</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabric_model.html">Hyperledger Fabric Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecases.html">Use Cases</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_network.html">Building Your First Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="write_first_app.html">Writing Your First Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaincode.html">Chaincode Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaincode4ade.html">Chaincode for Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="chaincode4noah.html">Chaincode for Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="videos.html">Videos</a></li>
</ul>
<p class="caption"><span class="caption-text">Operations Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="msp.html">Membership Service Providers (MSP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="configtx.html">Channel Configuration (configtx)</a></li>
<li class="toctree-l1"><a class="reference internal" href="configtxgen.html">Channel Configuration (configtxgen)</a></li>
<li class="toctree-l1"><a class="reference internal" href="configtxlator.html">Reconfiguring with configtxlator</a></li>
<li class="toctree-l1"><a class="reference internal" href="endorsement-policies.html">Endorsement policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="error-handling.html">Error handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="logging-control.html">Logging Control</a></li>
</ul>
<p class="caption"><span class="caption-text">Architecture</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="arch-deep-dive.html">Architecture Explained</a></li>
<li class="toctree-l1"><a class="reference internal" href="txflow.html">Transaction Flow</a></li>
<li class="toctree-l1"><a class="reference external" href="http://hyperledger-fabric-ca.readthedocs.io/en/latest">Hyperledger Fabric CA's User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="fabric-sdks.html">Hyperledger Fabric SDKs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bringing up a Kafka-based Ordering Service</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#caveat-emptor">Caveat emptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#big-picture">Big picture</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steps">Steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#additional-considerations">Additional considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#supported-kafka-versions-and-upgrading">Supported Kafka versions and upgrading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#debugging">Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="channels.html">Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="ledger.html">Ledger</a></li>
<li class="toctree-l1"><a class="reference internal" href="readwrite.html">Read-Write set semantics</a></li>
<li class="toctree-l1"><a class="reference internal" href="gossip.html">Gossip data dissemination protocol</a></li>
</ul>
<p class="caption"><span class="caption-text">Troubleshooting and FAQs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="MAINTAINERS.html">Maintainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="jira_navigation.html">Using Jira to understand current work items</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/devenv.html">Setting up the development environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html">Building Hyperledger Fabric</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#building-outside-of-vagrant">Building outside of Vagrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#configuration">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dev-setup/build.html#logging">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/lf-account.html">Requesting a Linux Foundation Account</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/gerrit.html">Working with Gerrit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/changes.html">Submitting a Change to Gerrit</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/reviewing.html">Reviewing a Change</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gerrit/best-practices.html">Gerrit Recommended Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html#generating-grpc-code">Generating gRPC code</a></li>
<li class="toctree-l1"><a class="reference internal" href="Style-guides/go-style.html#adding-or-updating-go-packages">Adding or updating Go packages</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Bringing up a Kafka-based Ordering Service</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/kafka.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bringing-up-a-kafka-based-ordering-service">
<h1>Bringing up a Kafka-based Ordering Service<a class="headerlink" href="#bringing-up-a-kafka-based-ordering-service" title="Permalink to this headline">¶</a></h1>
<div class="section" id="caveat-emptor">
<h2>Caveat emptor<a class="headerlink" href="#caveat-emptor" title="Permalink to this headline">¶</a></h2>
<p>This document assumes that the reader generally knows how to set up a Kafka
cluster and a ZooKeeper ensemble. The purpose of this guide is to identify the
steps you need to take so as to have a set of Hyperledger Fabric ordering
service nodes (OSNs) use your Kafka cluster and provide an ordering service to
your blockchain network.</p>
</div>
<div class="section" id="big-picture">
<h2>Big picture<a class="headerlink" href="#big-picture" title="Permalink to this headline">¶</a></h2>
<p>Each channel maps to a separate single-partition topic in Kafka. When
an OSN receives transactions via the <code class="docutils literal notranslate"><span class="pre">Broadcast</span></code> RPC, it checks to make sure
that the broadcasting client has permissions to write on the channel, then
relays (i.e. produces) those transactions to the appropriate partition in Kafka.
This partition is also consumed by the OSN which groups the received
transactions into blocks locally, persists them in its local ledger, and serves
them to receiving clients via the <code class="docutils literal notranslate"><span class="pre">Deliver</span></code> RPC. For low-level details, refer
to <a class="reference external" href="https://docs.google.com/document/d/1vNMaM7XhOlu9tB_10dKnlrhy5d7b1u8lSY8a-kVjCO4/edit">the document that describes how we came to this design</a>
– Figure 8 is a schematic representation of the process described above.</p>
</div>
<div class="section" id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h2>
<p>Let <code class="docutils literal notranslate"><span class="pre">K</span></code> and <code class="docutils literal notranslate"><span class="pre">Z</span></code> be the number of nodes in the Kafka cluster and the
ZooKeeper ensemble respectively:</p>
<p>i. At a minimum, <code class="docutils literal notranslate"><span class="pre">K</span></code> should be set to 4. (As we will explain in Step 4 below,
this is the minimum number of nodes necessary in order to exhibit crash fault
tolerance, i.e. with 4 brokers, you can have 1 broker go down, all channels will
continue to be writeable and readable, and new channels can be created.)</p>
<p>ii. <code class="docutils literal notranslate"><span class="pre">Z</span></code> will either be 3, 5, or 7. It has to be an odd number to avoid
split-brain scenarios, and larger than 1 in order to avoid single point of
failures. Anything beyond 7 ZooKeeper servers is considered an overkill.</p>
<p>Proceed as follows:</p>
<p>1. Orderers: <strong>Encode the Kafka-related information in the network’s genesis
block.</strong> If you are using <code class="docutils literal notranslate"><span class="pre">configtxgen</span></code>, edit <code class="docutils literal notranslate"><span class="pre">configtx.yaml</span></code> – or pick a
preset profile for the system channel’s genesis block –  so that:</p>
<blockquote>
<div><ol class="loweralpha simple">
<li><code class="docutils literal notranslate"><span class="pre">Orderer.OrdererType</span></code> is set to <code class="docutils literal notranslate"><span class="pre">kafka</span></code>.</li>
</ol>
<p>b. <code class="docutils literal notranslate"><span class="pre">Orderer.Kafka.Brokers</span></code> contains the address of <em>at least two</em> of the
Kafka brokers in your cluster in <code class="docutils literal notranslate"><span class="pre">IP:port</span></code> notation. The list does not
need to be exhaustive. (These are your seed brokers.)</p>
</div></blockquote>
<p>2. Orderers: <strong>Set the maximum block size.</strong> Each block will have at most
<cite>Orderer.AbsoluteMaxBytes</cite> bytes (not including headers), a value that you can
set in <code class="docutils literal notranslate"><span class="pre">configtx.yaml</span></code>. Let the value you pick here be <code class="docutils literal notranslate"><span class="pre">A</span></code> and make note of
it – it will affect how you configure your Kafka brokers in Step 4.</p>
<p>3. Orderers: <strong>Create the genesis block.</strong> Use <code class="docutils literal notranslate"><span class="pre">configtxgen</span></code>. The settings you
picked in Steps 1 and 2 above are system-wide settings, i.e. they apply across
the network for all the OSNs. Make note of the genesis block’s location.</p>
<p>4. Kafka cluster: <strong>Configure your Kafka brokers appropriately.</strong> Ensure that
every Kafka broker has these keys configured:</p>
<blockquote>
<div><p>a. <code class="docutils literal notranslate"><span class="pre">unclean.leader.election.enable</span> <span class="pre">=</span> <span class="pre">false</span></code> – Data consistency is key in
a blockchain environment. We cannot have a channel leader chosen outside of
the in-sync replica set, or we run the risk of overwriting the offsets that
the previous leader produced, and –as a result– rewrite the blockchain
that the orderers produce.</p>
<p>b.  <code class="docutils literal notranslate"><span class="pre">min.insync.replicas</span> <span class="pre">=</span> <span class="pre">M</span></code> – Where you pick a value <code class="docutils literal notranslate"><span class="pre">M</span></code> such that
1 &lt; M &lt; N (see <code class="docutils literal notranslate"><span class="pre">default.replication.factor</span></code> below). Data is considered
committed when it is written to at least <code class="docutils literal notranslate"><span class="pre">M</span></code> replicas (which are then
considered in-sync and belong to the in-sync replica set, or ISR). In any
other case, the write operation returns an error. Then:</p>
<blockquote>
<div>i. If up to N-M replicas – out of the <code class="docutils literal notranslate"><span class="pre">N</span></code> that the channel data is
written to – become unavailable, operations proceed normally.
ii. If more replicas become unavailable, Kafka cannot maintain an ISR
set of <code class="docutils literal notranslate"><span class="pre">M,</span></code> so it stops accepting writes. Reads work without issues.
The channel becomes writeable again when <code class="docutils literal notranslate"><span class="pre">M</span></code> replicas get in-sync.</div></blockquote>
<p>c. <code class="docutils literal notranslate"><span class="pre">default.replication.factor</span> <span class="pre">=</span> <span class="pre">N</span></code> – Where you pick a value <code class="docutils literal notranslate"><span class="pre">N</span></code> such
that N &lt; K. A replication factor of <code class="docutils literal notranslate"><span class="pre">N</span></code> means that each channel will have
its data replicated to <code class="docutils literal notranslate"><span class="pre">N</span></code> brokers. These are the candidates for the ISR
set of a channel. As we noted in the <code class="docutils literal notranslate"><span class="pre">min.insync.replicas</span> <span class="pre">section</span></code> above,
not all of these brokers have to be available all the time. <code class="docutils literal notranslate"><span class="pre">N</span></code> should be
set <em>strictly smaller</em> to <code class="docutils literal notranslate"><span class="pre">K</span></code> because channel creations cannot go forward
if less than <code class="docutils literal notranslate"><span class="pre">N</span></code> brokers are up. So if you set N = K, a single broker
going down means that no new channels can be created on the blockchain
network – the crash fault tolerance of the ordering service is
non-existent.</p>
<p>d. <code class="docutils literal notranslate"><span class="pre">message.max.bytes</span></code> and <code class="docutils literal notranslate"><span class="pre">replica.fetch.max.bytes</span></code> should be set to a
value larger than <code class="docutils literal notranslate"><span class="pre">A</span></code>, the value you picked in
<code class="docutils literal notranslate"><span class="pre">Orderer.AbsoluteMaxBytes</span></code> in Step 2 above. Add some buffer to account for
headers – 1 MiB is more than enough. The following condition applies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Orderer</span><span class="o">.</span><span class="n">AbsoluteMaxBytes</span> <span class="o">&lt;</span> <span class="n">replica</span><span class="o">.</span><span class="n">fetch</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">bytes</span> <span class="o">&lt;=</span> <span class="n">message</span><span class="o">.</span><span class="n">max</span><span class="o">.</span><span class="n">bytes</span>
</pre></div>
</div>
<p>(For completeness, we note that <code class="docutils literal notranslate"><span class="pre">message.max.bytes</span></code> should be strictly
smaller to <code class="docutils literal notranslate"><span class="pre">socket.request.max.bytes</span></code> which is set by default to 100 MiB.
If you wish to have blocks larger than 100 MiB you will need to edit the
hard-coded value in <code class="docutils literal notranslate"><span class="pre">brokerConfig.Producer.MaxMessageBytes</span></code> in
<code class="docutils literal notranslate"><span class="pre">fabric/orderer/kafka/config.go</span></code> and rebuild the binary from source.
This is not advisable.)</p>
<p>e. <code class="docutils literal notranslate"><span class="pre">log.retention.ms</span> <span class="pre">=</span> <span class="pre">-1</span></code>. Until the ordering service adds
support for pruning of the Kafka logs, you should disable time-based
retention and prevent segments from expiring. (Size-based retention – see
<code class="docutils literal notranslate"><span class="pre">log.retention.bytes</span></code> – is disabled by default in Kafka at the time of
this writing, so there’s no need to set it explicitly.)</p>
<p>Based on what we’ve described above, the minimum allowed values for <code class="docutils literal notranslate"><span class="pre">M</span></code>
and <code class="docutils literal notranslate"><span class="pre">N</span></code> are 2 and 3 respectively. This configuration allows for the
creation of new channels to go forward, and for all channels to continue to
be writeable.</p>
</div></blockquote>
<p>5. Orderers: <strong>Point each OSN to the genesis block.</strong> Edit
<code class="docutils literal notranslate"><span class="pre">General.GenesisFile</span></code> in <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code> so that it points to the genesis
block created in Step 3 above. (While at it, ensure all other keys in that YAML
file are set appropriately.)</p>
<ol class="arabic" start="6">
<li><p class="first">Orderers: <strong>Adjust polling intervals and timeouts.</strong> (Optional step.)</p>
<blockquote>
<div><p>a. The <code class="docutils literal notranslate"><span class="pre">Kafka.Retry</span></code> section in the <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code> file allows you to
adjust the frequency of the metadata/producer/consumer requests, as well as
the socket timeouts. (These are all settings you would expect to see in a
Kafka producer or consumer.)</p>
<p>b. Additionally, when a new channel is created, or when an existing channel
is reloaded (in case of a just-restarted orderer), the orderer interacts
with the Kafka cluster in the following ways:</p>
<blockquote>
<div><p>a. It creates a Kafka producer (writer) for the Kafka partition that
corresponds to the channel.</p>
<p>b. It uses that producer to post a no-op <code class="docutils literal notranslate"><span class="pre">CONNECT</span></code> message to that
partition.</p>
<ol class="loweralpha simple" start="3">
<li>It creates a Kafka consumer (reader) for that partition.</li>
</ol>
<p>If any of these steps fail, you can adjust the frequency with which they
are repeated. Specifically they will be re-attempted every
<code class="docutils literal notranslate"><span class="pre">Kafka.Retry.ShortInterval</span></code> for a total of <code class="docutils literal notranslate"><span class="pre">Kafka.Retry.ShortTotal</span></code>,
and then every <code class="docutils literal notranslate"><span class="pre">Kafka.Retry.LongInterval</span></code> for a total of
<code class="docutils literal notranslate"><span class="pre">Kafka.Retry.LongTotal</span></code> until they succeed. Note that the orderer will
be unable to write to or read from a channel until all of the steps
above have been completed successfully.</p>
</div></blockquote>
</div></blockquote>
</li>
</ol>
<p>7. <strong>Set up the OSNs and Kafka cluster so that they communicate over SSL.</strong>
(Optional step, but highly recommended.) Refer to <a class="reference external" href="http://docs.confluent.io/2.0.0/kafka/ssl.html">the Confluent guide</a> for the Kafka cluster side of
the equation, and set the keys under <code class="docutils literal notranslate"><span class="pre">Kafka.TLS</span></code> in <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code> on every
OSN accordingly.</p>
<p>8. <strong>Bring up the nodes in the following order: ZooKeeper ensemble, Kafka
cluster, ordering service nodes.</strong></p>
</div>
<div class="section" id="additional-considerations">
<h2>Additional considerations<a class="headerlink" href="#additional-considerations" title="Permalink to this headline">¶</a></h2>
<p>1. <strong>Preferred message size.</strong> In Step 2 above (see <a class="reference internal" href="#steps">Steps</a> section) you can
also set the preferred size of blocks by setting the
<code class="docutils literal notranslate"><span class="pre">Orderer.Batchsize.PreferredMaxBytes</span></code> key. Kafka offers higher throughput when
dealing with relatively small messages; aim for a value no bigger than 1 MiB.</p>
<p>2. <strong>Using environment variables to override settings.</strong> You can override a
Kafka broker or a ZooKeeper server’s settings by using environment variables.
Replace the dots of the configuration key with underscores –
e.g. <code class="docutils literal notranslate"><span class="pre">KAFKA_UNCLEAN_LEADER_ELECTION_ENABLE=false</span></code> will allow you to override
the default value of <code class="docutils literal notranslate"><span class="pre">unclean.leader.election.enable</span></code>. The same applies to the
OSNs for their <em>local</em> configuration, i.e. what can be set in <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code>.
For example <code class="docutils literal notranslate"><span class="pre">ORDERER_KAFKA_RETRY_SHORTINTERVAL=1s</span></code> allows you to override the
default value for <code class="docutils literal notranslate"><span class="pre">Orderer.Kafka.Retry.ShortInterval</span></code>.</p>
</div>
<div class="section" id="supported-kafka-versions-and-upgrading">
<h2>Supported Kafka versions and upgrading<a class="headerlink" href="#supported-kafka-versions-and-upgrading" title="Permalink to this headline">¶</a></h2>
<p>Supported Kafka versions for v1 are <code class="docutils literal notranslate"><span class="pre">0.9</span></code> and <code class="docutils literal notranslate"><span class="pre">0.10</span></code>. (Hyperledger Fabric
uses the <a class="reference external" href="https://github.com/Shopify/sarama">sarama client library</a>
and vendors a version of it that supports Kafka 0.9 and 0.10.)</p>
<p>Out of the box the Kafka version defaults to <code class="docutils literal notranslate"><span class="pre">0.9.0.1</span></code>. If you wish to use a
different supported version, specify a supported version using the
<code class="docutils literal notranslate"><span class="pre">Kafka.Version</span></code> key in <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code>.</p>
<p>The current supported Kafka versions are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Version:</span> <span class="pre">0.9.0.1</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Version:</span> <span class="pre">0.10.0.0</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Version:</span> <span class="pre">0.10.0.1</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Version:</span> <span class="pre">0.10.1.0</span></code></li>
</ul>
</div>
<div class="section" id="debugging">
<h2>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>Set <code class="docutils literal notranslate"><span class="pre">General.LogLevel</span></code> to <code class="docutils literal notranslate"><span class="pre">DEBUG</span></code> and <code class="docutils literal notranslate"><span class="pre">Kafka.Verbose</span></code> in <code class="docutils literal notranslate"><span class="pre">orderer.yaml</span></code>
to <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Sample Docker Compose configuration files inline with the recommended settings
above can be found under the <code class="docutils literal notranslate"><span class="pre">fabric/bddtests</span></code> directory. Look for
<code class="docutils literal notranslate"><span class="pre">dc-orderer-kafka-base.yml</span></code> and <code class="docutils literal notranslate"><span class="pre">dc-orderer-kafka.yml</span></code>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="channels.html" class="btn btn-neutral float-right" title="Channels" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="fabric-sdks.html" class="btn btn-neutral" title="Hyperledger Fabric SDKs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>