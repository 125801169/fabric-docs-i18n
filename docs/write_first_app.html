

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing Your First Application &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Adding an Org to a Channel" href="channel_update_tutorial.html" />
    <link rel="prev" title="Building Your First Network" href="build_network.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
<br>
<a href="https://chat.hyperledger.org">Rocket Chat</a>  <a href="https://jenkins.hyperledger.org/">CI</a>
<a href="http://stackoverflow.com/questions/tagged/hyperledger-fabric">StackOverflow</a>
<br>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
  <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
  <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Welcome to Hyperledger Fabric</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="build_network.html">Building Your First Network</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing Your First Application</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setting-up-your-dev-environment">Setting up your Dev Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#how-applications-interact-with-the-network">How Applications Interact with the Network</a></li>
<li class="toctree-l4"><a class="reference internal" href="#enrolling-the-admin-user">Enrolling the Admin User</a></li>
<li class="toctree-l4"><a class="reference internal" href="#register-and-enroll-user1">Register and Enroll <code class="docutils literal notranslate"><span class="pre">user1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#querying-the-ledger">Querying the Ledger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#updating-the-ledger">Updating the Ledger</a></li>
<li class="toctree-l4"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="channel_update_tutorial.html">Adding an Org to a Channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="upgrading_your_network_tutorial.html">Upgrading Your Network Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="chaincode.html">Chaincode Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="chaincode4ade.html">Chaincode for Developers</a></li>
<li class="toctree-l3"><a class="reference internal" href="chaincode4noah.html">Chaincode for Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="systemchaincode.html">System Chaincode Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="videos.html">Videos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l2"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Architecture Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l2"><a class="reference internal" href="status.html">Status</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Key Concepts</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="build_network.html">Building Your First Network</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Writing Your First Application</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-up-your-dev-environment">Setting up your Dev Environment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#install-the-clients-launch-the-network">Install the clients &amp; launch the network</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#how-applications-interact-with-the-network">How Applications Interact with the Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enrolling-the-admin-user">Enrolling the Admin User</a></li>
<li class="toctree-l3"><a class="reference internal" href="#register-and-enroll-user1">Register and Enroll <code class="docutils literal notranslate"><span class="pre">user1</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#querying-the-ledger">Querying the Ledger</a></li>
<li class="toctree-l3"><a class="reference internal" href="#updating-the-ledger">Updating the Ledger</a></li>
<li class="toctree-l3"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-resources">Additional Resources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="channel_update_tutorial.html">Adding an Org to a Channel</a></li>
<li class="toctree-l2"><a class="reference internal" href="upgrading_your_network_tutorial.html">Upgrading Your Network Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="chaincode.html">Chaincode Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="chaincode4ade.html">Chaincode for Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="chaincode4noah.html">Chaincode for Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="systemchaincode.html">System Chaincode Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="videos.html">Videos</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ops_guide.html">Operations Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">Commands Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">Hyperledger Fabric FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="ordering-service-faq.html">Ordering Service FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributions Welcome!</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">Still Have Questions?</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">Status</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Writing Your First Application</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/write_first_app.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="writing-your-first-application">
<h1>Writing Your First Application<a class="headerlink" href="#writing-your-first-application" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you’re not yet familiar with the fundamental architecture of a
Fabric network, you may want to visit the <a class="reference internal" href="blockchain.html"><span class="doc">Introduction</span></a> and
<a class="reference internal" href="build_network.html"><span class="doc">Building Your First Network</span></a> documentation prior to continuing.</p>
</div>
<p>In this section we’ll be looking at a handful of sample programs to see how Fabric
apps work. These apps (and the smart contract they use) – collectively known as
<code class="docutils literal notranslate"><span class="pre">fabcar</span></code> – provide a broad demonstration of Fabric functionality.  Notably, we
will show the process for interacting with a Certificate Authority and generating
enrollment certificates, after which we will leverage these generated identities
(user objects) to query and update a ledger.</p>
<p>We’ll go through three principle steps:</p>
<blockquote>
<div><p><strong>1. Setting up a development environment.</strong> Our application needs a network to
interact with, so we’ll download one stripped down to just the components we need
for registration/enrollment, queries and updates:</p>
<img alt="_images/AppConceptsOverview.png" src="_images/AppConceptsOverview.png" />
<p><strong>2. Learning the parameters of the sample smart contract our app will use.</strong> Our
smart contract contains various functions that allow us to interact with the ledger
in different ways. We’ll go in and inspect that smart contract to learn about the
functions our applications will be using.</p>
<p><strong>3. Developing the applications to be able to query and update assets on the ledger.</strong>
We’ll get into the app code itself (our apps have been written in Javascript) and
manually manipulate the variables to run different kinds of queries and updates.</p>
</div></blockquote>
<p>After completing this tutorial you should have a basic understanding of how
an application is programmed in conjunction with a smart contract to interact
with the ledger (i.e. the peer) on a Fabric network.</p>
<div class="section" id="setting-up-your-dev-environment">
<h2>Setting up your Dev Environment<a class="headerlink" href="#setting-up-your-dev-environment" title="Permalink to this headline">¶</a></h2>
<p>First thing, let’s download the Fabric images and the accompanying artifacts for the network
and applications…</p>
<p>Visit the <a class="reference internal" href="prereqs.html"><span class="doc">Prerequisites</span></a> page and ensure you have the necessary dependencies
installed on your machine.</p>
<p>Next, visit the <a class="reference internal" href="samples.html"><span class="doc">Hyperledger Fabric Samples</span></a> page and follow the provided instructions.  Return to
this tutorial once you have cloned the <code class="docutils literal notranslate"><span class="pre">fabric-samples</span></code> repository, and downloaded
the latest stable Fabric images and available utilities.</p>
<p>At this point everything should be installed.  Navigate to the <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> subdirectory
within your <code class="docutils literal notranslate"><span class="pre">fabric-samples</span></code> repository and take a look at what’s inside:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">fabric</span><span class="o">-</span><span class="n">samples</span><span class="o">/</span><span class="n">fabcar</span>  <span class="o">&amp;&amp;</span> <span class="n">ls</span>
</pre></div>
</div>
<p>You should see the following:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enrollAdmin</span><span class="o">.</span><span class="n">js</span>     <span class="n">invoke</span><span class="o">.</span><span class="n">js</span>       <span class="n">package</span><span class="o">.</span><span class="n">json</span>    <span class="n">query</span><span class="o">.</span><span class="n">js</span>        <span class="n">registerUser</span><span class="o">.</span><span class="n">js</span> <span class="n">startFabric</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Before starting we also need to do a little housekeeping.  Run the following command to
kill any stale or active containers:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span>docker rm -f $(docker ps -aq)
</pre></div>
</div>
<p>Clear any cached networks:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Press &#39;y&#39; when prompted by the command</span>

<span class="n">docker</span> <span class="n">network</span> <span class="n">prune</span>
</pre></div>
</div>
<p>And lastly if you’ve already run through this tutorial, you’ll also want to delete the
underlying chaincode image for the <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> smart contract.  If you’re a user going through
this content for the first time, then you won’t have this chaincode image on your system:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">rmi</span> <span class="n">dev</span><span class="o">-</span><span class="n">peer0</span><span class="o">.</span><span class="n">org1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="o">-</span><span class="n">fabcar</span><span class="o">-</span><span class="mf">1.0</span><span class="o">-</span><span class="mi">5</span><span class="n">c906e402ed29f20260ae42283216aa75549c571e2e380f3615826365d8269ba</span>
</pre></div>
</div>
<div class="section" id="install-the-clients-launch-the-network">
<h3>Install the clients &amp; launch the network<a class="headerlink" href="#install-the-clients-launch-the-network" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following instructions require you to be in the <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> subdirectory
within your local clone of the <code class="docutils literal notranslate"><span class="pre">fabric-samples</span></code> repo.  Remain at the
root of this subdirectory for the remainder of this tutorial.</p>
</div>
<p>Run the following command to install the Fabric dependencies for the applications.
We are concerned with <code class="docutils literal notranslate"><span class="pre">fabric-ca-client</span></code> which will allow our app(s) to communicate
with the CA server and retrieve identity material, and with <code class="docutils literal notranslate"><span class="pre">fabric-client</span></code> which
allows us to load the identity material and talk to the peers and ordering service.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">npm</span> <span class="n">install</span>
</pre></div>
</div>
<p>Launch your network using the <code class="docutils literal notranslate"><span class="pre">startFabric.sh</span></code> shell script.  This command
will spin up our various Fabric entities and launch a smart contract container for
chaincode written in Golang:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">startFabric</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>You also have the option of running this tutorial against chaincode written in
<a class="reference external" href="https://fabric-shim.github.io/">Node.js</a>.  If you’d like to pursue this route, issue the following command instead:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">startFabric</span><span class="o">.</span><span class="n">sh</span> <span class="n">node</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Be aware that the Node.js chaincode scenario will take roughly 90 seconds
to complete; perhaps longer.  The script is not hanging, rather the
increased time is a result of the fabric-shim being installed as the
chaincode image is being built.</p>
</div>
<p>Alright, now that you’ve got a sample network and some code, let’s take a
look at how the different pieces fit together.</p>
</div>
</div>
<div class="section" id="how-applications-interact-with-the-network">
<h2>How Applications Interact with the Network<a class="headerlink" href="#how-applications-interact-with-the-network" title="Permalink to this headline">¶</a></h2>
<p>For a more in-depth look at the components in our <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> network (and how
they’re deployed) as well as how applications interact with those components
on more of a granular level, see <a class="reference internal" href="understand_fabcar_network.html"><span class="doc">Understanding the Fabcar Network</span></a>.</p>
<p>Developers more interested in seeing what applications <strong>do</strong> – as well as
looking at the code itself to see how an application is constructed – should
continue. For now, the most important thing to know is that applications use
a software development kit (SDK) to access the <strong>APIs</strong> that permit queries and
updates to the ledger.</p>
</div>
<div class="section" id="enrolling-the-admin-user">
<h2>Enrolling the Admin User<a class="headerlink" href="#enrolling-the-admin-user" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The following two sections involve communication with the Certificate
Authority.  You may find it useful to stream the CA logs when running
the upcoming programs.</p>
</div>
<p>To stream your CA logs, split your terminal or open a new shell and issue the following:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">logs</span> <span class="o">-</span><span class="n">f</span> <span class="n">ca</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Now hop back to your terminal with the <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> content…</p>
<p>When we launched our network, an admin user - <code class="docutils literal notranslate"><span class="pre">admin</span></code> - was registered with our
Certificate Authority.  Now we need to send an enroll call to the CA server and
retrieve the enrollment certificate (eCert) for this user.  We won’t delve into enrollment
details here, but suffice it to say that the SDK and by extension our applications
need this cert in order to form a user object for the admin.  We will then use this admin
object to subsequently register and enroll a new user.  Send the admin enroll call to the CA
server:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">enrollAdmin</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>This program will invoke a certificate signing request (CSR) and ultimately output
an eCert and key material into a newly created folder - <code class="docutils literal notranslate"><span class="pre">hfc-key-store</span></code> - at the
root of this project.  Our apps will then look to this location when they need to
create or load the identity objects for our various users.</p>
</div>
<div class="section" id="register-and-enroll-user1">
<h2>Register and Enroll <code class="docutils literal notranslate"><span class="pre">user1</span></code><a class="headerlink" href="#register-and-enroll-user1" title="Permalink to this headline">¶</a></h2>
<p>With our newly generated admin eCert, we will now communicate with the CA server
once more to register and enroll a new user.  This user - <code class="docutils literal notranslate"><span class="pre">user1</span></code> - will be
the identity we use when querying and updating the ledger.  It’s important to
note here that it is the <code class="docutils literal notranslate"><span class="pre">admin</span></code> identity that is issuing the registration and
enrollment calls for our new user (i.e. this user is acting in the role of a registrar).
Send the register and enroll calls for <code class="docutils literal notranslate"><span class="pre">user1</span></code>:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">registerUser</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>Similar to the admin enrollment, this program invokes a CSR and outputs the keys
and eCert into the <code class="docutils literal notranslate"><span class="pre">hfc-key-store</span></code> subdirectory.  So now we have identity material for two
separate users - <code class="docutils literal notranslate"><span class="pre">admin</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">user1</span></code>.  Time to interact with the ledger…</p>
</div>
<div class="section" id="querying-the-ledger">
<h2>Querying the Ledger<a class="headerlink" href="#querying-the-ledger" title="Permalink to this headline">¶</a></h2>
<p>Queries are how you read data from the ledger. This data is stored as a series
of key/value pairs, and you can query for the value of a single key, multiple
keys, or – if the ledger is written in a rich data storage format like JSON –
perform complex searches against it (looking for all assets that contain
certain keywords, for example).</p>
<p>This is a representation of how a query works:</p>
<img alt="_images/QueryingtheLedger.png" src="_images/QueryingtheLedger.png" />
<p>First, let’s run our <code class="docutils literal notranslate"><span class="pre">query.js</span></code> program to return a listing of all the cars on
the ledger.  We will use our second identity - <code class="docutils literal notranslate"><span class="pre">user1</span></code> - as the signing entity
for this application.  The following line in our program specifies <code class="docutils literal notranslate"><span class="pre">user1</span></code> as
the signer:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fabric_client</span><span class="o">.</span><span class="n">getUserContext</span><span class="p">(</span><span class="s1">&#39;user1&#39;</span><span class="p">,</span> <span class="n">true</span><span class="p">);</span>
</pre></div>
</div>
<p>Recall that the <code class="docutils literal notranslate"><span class="pre">user1</span></code> enrollment material has already been placed into our
<code class="docutils literal notranslate"><span class="pre">hfc-key-store</span></code> subdirectory, so we simply need to tell our application to grab that identity.
With the user object defined, we can now proceed with reading from the ledger.
A function that will query all the cars, <code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code>, is
pre-loaded in the app, so we can simply run the program as is:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">query</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>It should return something like this:</p>
<div class="code json highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Successfully</span> <span class="n">loaded</span> <span class="n">user1</span> <span class="kn">from</span> <span class="nn">persistence</span>
<span class="n">Query</span> <span class="n">has</span> <span class="n">completed</span><span class="p">,</span> <span class="n">checking</span> <span class="n">results</span>
<span class="n">Response</span> <span class="ow">is</span>  <span class="p">[{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR0&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Toyota&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Prius&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Tomoko&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR1&quot;</span><span class="p">,</span>   <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;red&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Ford&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Mustang&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Brad&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR2&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Hyundai&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Tucson&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Jin Soo&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR3&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;yellow&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Volkswagen&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Passat&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Max&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR4&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Tesla&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Adriana&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR5&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;purple&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Peugeot&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;205&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Michel&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR6&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;white&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Chery&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;S22L&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Aarav&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR7&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;violet&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Fiat&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Punto&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Pari&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR8&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;indigo&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Tata&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Nano&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Valeria&quot;</span><span class="p">}},</span>
<span class="p">{</span><span class="s2">&quot;Key&quot;</span><span class="p">:</span><span class="s2">&quot;CAR9&quot;</span><span class="p">,</span> <span class="s2">&quot;Record&quot;</span><span class="p">:{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;brown&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Holden&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Barina&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Shotaro&quot;</span><span class="p">}}]</span>
</pre></div>
</div>
<p>These are the 10 cars. A black Tesla Model S owned by Adriana, a red Ford Mustang
owned by Brad, a violet Fiat Punto owned by Pari, and so on. The ledger is
key/value based and in our implementation the key is <code class="docutils literal notranslate"><span class="pre">CAR0</span></code> through <code class="docutils literal notranslate"><span class="pre">CAR9</span></code>.
This will become particularly important in a moment.</p>
<p>Let’s take a closer look at this program.  Use an editor (e.g. atom or visual studio)
and open <code class="docutils literal notranslate"><span class="pre">query.js</span></code>.</p>
<p>The initial section of the application defines certain variables such as
channel name, cert store location and network endpoints. In our sample app, these
variables have been baked-in, but in a real app these variables would have to
be specified by the app dev.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">fabric_client</span><span class="o">.</span><span class="n">newChannel</span><span class="p">(</span><span class="s1">&#39;mychannel&#39;</span><span class="p">);</span>
<span class="n">var</span> <span class="n">peer</span> <span class="o">=</span> <span class="n">fabric_client</span><span class="o">.</span><span class="n">newPeer</span><span class="p">(</span><span class="s1">&#39;grpc://localhost:7051&#39;</span><span class="p">);</span>
<span class="n">channel</span><span class="o">.</span><span class="n">addPeer</span><span class="p">(</span><span class="n">peer</span><span class="p">);</span>

<span class="n">var</span> <span class="n">member_user</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
<span class="n">var</span> <span class="n">store_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">__dirname</span><span class="p">,</span> <span class="s1">&#39;hfc-key-store&#39;</span><span class="p">);</span>
<span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s1">&#39;Store path:&#39;</span><span class="o">+</span><span class="n">store_path</span><span class="p">);</span>
<span class="n">var</span> <span class="n">tx_id</span> <span class="o">=</span> <span class="n">null</span><span class="p">;</span>
</pre></div>
</div>
<p>This is the chunk where we construct our query:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">queryCar</span> <span class="n">chaincode</span> <span class="n">function</span> <span class="o">-</span> <span class="n">requires</span> <span class="mi">1</span> <span class="n">argument</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span> <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR4&#39;</span><span class="p">],</span>
<span class="o">//</span> <span class="n">queryAllCars</span> <span class="n">chaincode</span> <span class="n">function</span> <span class="o">-</span> <span class="n">requires</span> <span class="n">no</span> <span class="n">arguments</span> <span class="p">,</span> <span class="n">ex</span><span class="p">:</span> <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
<span class="n">const</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span> <span class="p">:</span> <span class="o">---</span> <span class="n">letting</span> <span class="n">this</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peers</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">channel</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;queryAllCars&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>When the application ran, it invoked the <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> chaincode on the peer, ran the
<code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code> function within it, and passed no arguments to it.</p>
<p>To take a look at the available functions within our smart contract, navigate
to the <code class="docutils literal notranslate"><span class="pre">chaincode/fabcar/go</span></code> subdirectory at the root of <code class="docutils literal notranslate"><span class="pre">fabric-samples</span></code> and open
<code class="docutils literal notranslate"><span class="pre">fabcar.go</span></code> in your editor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These same functions are defined within the Node.js version of the
<code class="docutils literal notranslate"><span class="pre">fabcar</span></code> chaincode.</p>
</div>
<p>You’ll see that we have the following functions available to call: <code class="docutils literal notranslate"><span class="pre">initLedger</span></code>,
<code class="docutils literal notranslate"><span class="pre">queryCar</span></code>, <code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code>, <code class="docutils literal notranslate"><span class="pre">createCar</span></code>, and <code class="docutils literal notranslate"><span class="pre">changeCarOwner</span></code>.</p>
<p>Let’s take a closer look at the <code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code> function to see how it
interacts with the ledger.</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">SmartContract</span><span class="p">)</span> <span class="n">queryAllCars</span><span class="p">(</span><span class="n">APIstub</span> <span class="n">shim</span><span class="o">.</span><span class="n">ChaincodeStubInterface</span><span class="p">)</span> <span class="n">sc</span><span class="o">.</span><span class="n">Response</span> <span class="p">{</span>

      <span class="n">startKey</span> <span class="p">:</span><span class="o">=</span> <span class="s2">&quot;CAR0&quot;</span>
      <span class="n">endKey</span> <span class="p">:</span><span class="o">=</span> <span class="s2">&quot;CAR999&quot;</span>

      <span class="n">resultsIterator</span><span class="p">,</span> <span class="n">err</span> <span class="p">:</span><span class="o">=</span> <span class="n">APIstub</span><span class="o">.</span><span class="n">GetStateByRange</span><span class="p">(</span><span class="n">startKey</span><span class="p">,</span> <span class="n">endKey</span><span class="p">)</span>
</pre></div>
</div>
<p>This defines the range of <code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code>. Every car between <code class="docutils literal notranslate"><span class="pre">CAR0</span></code> and
<code class="docutils literal notranslate"><span class="pre">CAR999</span></code> – 1,000 cars in all, assuming every key has been tagged properly
– will be returned by the query.</p>
<p>Below is a representation of how an app would call different functions in
chaincode.  Each function must be coded against an available API in the chaincode
shim interface, which in turn allows the smart contract container to properly
interface with the peer ledger.</p>
<img alt="_images/RunningtheSample.png" src="_images/RunningtheSample.png" />
<p>We can see our <code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code> function, as well as one called <code class="docutils literal notranslate"><span class="pre">createCar</span></code>,
that will allow us to update the ledger and ultimately append a new block to
the chain in a moment.</p>
<p>But first, go back to the <code class="docutils literal notranslate"><span class="pre">query.js</span></code> program and edit the constructor request
to query <code class="docutils literal notranslate"><span class="pre">CAR4</span></code>. We do this by changing the function in <code class="docutils literal notranslate"><span class="pre">query.js</span></code> from
<code class="docutils literal notranslate"><span class="pre">queryAllCars</span></code> to <code class="docutils literal notranslate"><span class="pre">queryCar</span></code> and passing <code class="docutils literal notranslate"><span class="pre">CAR4</span></code> as the specific key.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">query.js</span></code> program should now look like this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span> <span class="p">:</span> <span class="o">---</span> <span class="n">letting</span> <span class="n">this</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peers</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">channel</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;queryCar&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR4&#39;</span><span class="p">]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Save the program and navigate back to your <code class="docutils literal notranslate"><span class="pre">fabcar</span></code> directory.  Now run the
program again:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">query</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>You should see the following:</p>
<div class="code json highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Tesla&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;S&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Adriana&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>If you go back and look at the result from when we queried every car before,
you can see that <code class="docutils literal notranslate"><span class="pre">CAR4</span></code> was Adriana’s black Tesla model S, which is the result
that was returned here.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">queryCar</span></code> function, we can query against any key (e.g. <code class="docutils literal notranslate"><span class="pre">CAR0</span></code>)
and get whatever make, model, color, and owner correspond to that car.</p>
<p>Great. At this point you should be comfortable with the basic query functions
in the smart contract and the handful of parameters in the query program.
Time to update the ledger…</p>
</div>
<div class="section" id="updating-the-ledger">
<h2>Updating the Ledger<a class="headerlink" href="#updating-the-ledger" title="Permalink to this headline">¶</a></h2>
<p>Now that we’ve done a few ledger queries and added a bit of code, we’re ready to
update the ledger. There are a lot of potential updates we could make, but
let’s start by creating a car.</p>
<p>Below we can see how this process works. An update is proposed, endorsed,
then returned to the application, which in turn sends it to be ordered and
written to every peer’s ledger:</p>
<img alt="_images/UpdatingtheLedger.png" src="_images/UpdatingtheLedger.png" />
<p>Our first update to the ledger will be to create a new car.  We have a separate
Javascript program – <code class="docutils literal notranslate"><span class="pre">invoke.js</span></code> – that we will use to make updates. Just
as with queries, use an editor to open the program and navigate to the
code block where we construct our invocation:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">createCar</span> <span class="n">chaincode</span> <span class="n">function</span> <span class="o">-</span> <span class="n">requires</span> <span class="mi">5</span> <span class="n">args</span><span class="p">,</span> <span class="n">ex</span><span class="p">:</span> <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR12&#39;</span><span class="p">,</span> <span class="s1">&#39;Honda&#39;</span><span class="p">,</span> <span class="s1">&#39;Accord&#39;</span><span class="p">,</span> <span class="s1">&#39;Black&#39;</span><span class="p">,</span> <span class="s1">&#39;Tom&#39;</span><span class="p">],</span>
<span class="o">//</span> <span class="n">changeCarOwner</span> <span class="n">chaincode</span> <span class="n">function</span> <span class="o">-</span> <span class="n">requires</span> <span class="mi">2</span> <span class="n">args</span> <span class="p">,</span> <span class="n">ex</span><span class="p">:</span> <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR10&#39;</span><span class="p">,</span> <span class="s1">&#39;Barry&#39;</span><span class="p">],</span>
<span class="o">//</span> <span class="n">must</span> <span class="n">send</span> <span class="n">the</span> <span class="n">proposal</span> <span class="n">to</span> <span class="n">endorsing</span> <span class="n">peers</span>
<span class="n">var</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span><span class="p">:</span> <span class="n">let</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peer</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">client</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">],</span>
  <span class="n">chainId</span><span class="p">:</span> <span class="s1">&#39;mychannel&#39;</span><span class="p">,</span>
  <span class="n">txId</span><span class="p">:</span> <span class="n">tx_id</span>
<span class="p">};</span>
</pre></div>
</div>
<p>You’ll see that we can call one of two functions - <code class="docutils literal notranslate"><span class="pre">createCar</span></code> or
<code class="docutils literal notranslate"><span class="pre">changeCarOwner</span></code>. First, let’s create a red Chevy Volt and give it to an
owner named Nick. We’re up to <code class="docutils literal notranslate"><span class="pre">CAR9</span></code> on our ledger, so we’ll use <code class="docutils literal notranslate"><span class="pre">CAR10</span></code>
as the identifying key here. Edit this code block to look like this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span><span class="p">:</span> <span class="n">let</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peer</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">client</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;createCar&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR10&#39;</span><span class="p">,</span> <span class="s1">&#39;Chevy&#39;</span><span class="p">,</span> <span class="s1">&#39;Volt&#39;</span><span class="p">,</span> <span class="s1">&#39;Red&#39;</span><span class="p">,</span> <span class="s1">&#39;Nick&#39;</span><span class="p">],</span>
  <span class="n">chainId</span><span class="p">:</span> <span class="s1">&#39;mychannel&#39;</span><span class="p">,</span>
  <span class="n">txId</span><span class="p">:</span> <span class="n">tx_id</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Save it and run the program:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">invoke</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>There will be some output in the terminal about <code class="docutils literal notranslate"><span class="pre">ProposalResponse</span></code> and
promises. However, all we’re concerned with is this message:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">transaction</span> <span class="n">has</span> <span class="n">been</span> <span class="n">committed</span> <span class="n">on</span> <span class="n">peer</span> <span class="n">localhost</span><span class="p">:</span><span class="mi">7053</span>
</pre></div>
</div>
<p>To see that this transaction has been written, go back to <code class="docutils literal notranslate"><span class="pre">query.js</span></code> and
change the argument from <code class="docutils literal notranslate"><span class="pre">CAR4</span></code> to <code class="docutils literal notranslate"><span class="pre">CAR10</span></code>.</p>
<p>In other words, change this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span> <span class="p">:</span> <span class="o">---</span> <span class="n">letting</span> <span class="n">this</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peers</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">channel</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;queryCar&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR4&#39;</span><span class="p">]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>To this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">const</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span> <span class="p">:</span> <span class="o">---</span> <span class="n">letting</span> <span class="n">this</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peers</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">channel</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;queryCar&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR10&#39;</span><span class="p">]</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Save once again, then query:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">query</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>Which should return this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Response</span> <span class="ow">is</span>  <span class="p">{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Chevy&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Volt&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Nick&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Congratulations. You’ve created a car!</p>
<p>So now that we’ve done that, let’s say that Nick is feeling generous and he
wants to give his Chevy Volt to someone named Dave.</p>
<p>To do this go back to <code class="docutils literal notranslate"><span class="pre">invoke.js</span></code> and change the function from <code class="docutils literal notranslate"><span class="pre">createCar</span></code>
to <code class="docutils literal notranslate"><span class="pre">changeCarOwner</span></code> and input the arguments like this:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="n">request</span> <span class="o">=</span> <span class="p">{</span>
  <span class="o">//</span><span class="n">targets</span><span class="p">:</span> <span class="n">let</span> <span class="n">default</span> <span class="n">to</span> <span class="n">the</span> <span class="n">peer</span> <span class="n">assigned</span> <span class="n">to</span> <span class="n">the</span> <span class="n">client</span>
  <span class="n">chaincodeId</span><span class="p">:</span> <span class="s1">&#39;fabcar&#39;</span><span class="p">,</span>
  <span class="n">fcn</span><span class="p">:</span> <span class="s1">&#39;changeCarOwner&#39;</span><span class="p">,</span>
  <span class="n">args</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CAR10&#39;</span><span class="p">,</span> <span class="s1">&#39;Dave&#39;</span><span class="p">],</span>
  <span class="n">chainId</span><span class="p">:</span> <span class="s1">&#39;mychannel&#39;</span><span class="p">,</span>
  <span class="n">txId</span><span class="p">:</span> <span class="n">tx_id</span>
<span class="p">};</span>
</pre></div>
</div>
<p>The first argument – <code class="docutils literal notranslate"><span class="pre">CAR10</span></code> – reflects the car that will be changing
owners. The second argument – <code class="docutils literal notranslate"><span class="pre">Dave</span></code> – defines the new owner of the car.</p>
<p>Save and execute the program again:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">invoke</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>Now let’s query the ledger again and ensure that Dave is now associated with the
<code class="docutils literal notranslate"><span class="pre">CAR10</span></code> key:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="n">query</span><span class="o">.</span><span class="n">js</span>
</pre></div>
</div>
<p>It should return this result:</p>
<div class="code bash highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Response</span> <span class="ow">is</span>  <span class="p">{</span><span class="s2">&quot;colour&quot;</span><span class="p">:</span><span class="s2">&quot;Red&quot;</span><span class="p">,</span><span class="s2">&quot;make&quot;</span><span class="p">:</span><span class="s2">&quot;Chevy&quot;</span><span class="p">,</span><span class="s2">&quot;model&quot;</span><span class="p">:</span><span class="s2">&quot;Volt&quot;</span><span class="p">,</span><span class="s2">&quot;owner&quot;</span><span class="p">:</span><span class="s2">&quot;Dave&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The ownership of <code class="docutils literal notranslate"><span class="pre">CAR10</span></code> has been changed from Nick to Dave.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a real world application the chaincode would likely have some access
control logic. For example, only certain authorized users may create
new cars, and only the car owner may transfer the car to somebody else.</p>
</div>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Now that we’ve done a few queries and a few updates, you should have a pretty
good sense of how applications interact with the network. You’ve seen the basics
of the roles smart contracts, APIs, and the SDK play in queries and updates and
you should have a feel for how different kinds of applications could be used to
perform other business tasks and operations.</p>
<p>In subsequent documents we’ll learn how to actually <strong>write</strong> a smart contract
and how some of these more low level application functions can be leveraged
(especially relating to identity and membership services).</p>
</div>
<div class="section" id="additional-resources">
<h2>Additional Resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://github.com/hyperledger/fabric-sdk-node">Hyperledger Fabric Node SDK repo</a>
is an excellent resource for deeper documentation and sample code.  You can also consult
the Fabric community and component experts on <a class="reference external" href="https://chat.hyperledger.org/home">Hyperledger Rocket Chat</a>.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="channel_update_tutorial.html" class="btn btn-neutral float-right" title="Adding an Org to a Channel" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="build_network.html" class="btn btn-neutral" title="Building Your First Network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2017.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>